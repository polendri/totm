<canvas id='quintusContainer1' width='400' height='300' style='margin: auto;'></canvas>
<script>
window.addEventListener('load',function() {
  var Q = Quintus({                  // Create a new engine instance
    development: true,               // Forces assets to not be cached, turn
                                     // this off for production
    imagePath: "http://{{ site.baseurl }}/assets/quintus/part2/game1/images/",
    dataPath:  "http://{{ site.baseurl }}/assets/quintus/part2/game1/data/",
  })
  .include("Sprites, Scenes, Input, Anim, 2D, Touch, UI, TMX") // Load all needed modules
  .setup("quintusContainer1")
  .controls()                        // Add in default controls (keyboard, buttons)
  .touch();                          // Add in touch support (for the UI)

  Q.Sprite.extend("Player",{
    init: function(p) {
      this._super(p, { asset: "mario.png", jumpSpeed: -400, speed: 300 });
      this.add('2d, platformerControls');
    },
    step: function(dt) {
      if(Q.inputs['left'] && this.p.direction == 'right') {
        this.p.flip = 'x';
      } 
      else if(Q.inputs['right']  && this.p.direction == 'left') {
        this.p.flip = false;                    
      }
    }                    
  });

  Q.scene("level1", function(stage) {          
    Q.stageTMX("map.tmx", stage);
    var player = stage.insert(new Q.Player({ x: 3*16 + 8, y: 24*16 + 8}));
    stage.add("viewport").follow(player);
  });

  Q.loadTMX("map.tmx, mario.png", function() {
    Q.stageScene("level1");
  });
});
</script>
